{% extends 'portfolio/base.html' %}
{% load static %}

{% block title %}ğ•¬ğ–‘ğ–‘ğ–†ğ–“ ğ•±ğ–†ğ–Ÿğ–šğ–‘{% endblock %}

{% block og_image %}
  {% if projects and projects.0.image %}
    <meta property="og:image" content="{{ projects.0.image.url }}">
  {% endif %}
{% endblock %}

{% block content %}

<style>
/* ===============================
   PAGE-SCOPED STYLES ONLY
   (NO body / html overrides)
================================ */

.hero {
  text-align: center;
  padding: 4rem 1rem;
  background: linear-gradient(135deg, #0f172a, #1e293b);
  color: #fff;
}

.hero h1 {
  font-size: clamp(2rem, 6vw, 2.8rem);
  font-weight: 700;
}

.cursor {
  animation: blink 1s infinite;
}
@keyframes blink {
  0%,100%{opacity:1}
  50%{opacity:0}
}

/* ===============================
   SECTIONS
================================ */
.section {
  display: none;
  animation: fadeIn .35s ease-in-out;
}
.section.active { display:block; }

@keyframes fadeIn {
  from { opacity:0; transform:translateY(10px); }
  to { opacity:1; transform:translateY(0); }
}

.section-title {
  text-align:center;
  font-size:1.8rem;
  margin-bottom:1.5rem;
  color:#0d6efd;
}

/* ===============================
   GRID (MOBILE FIRST)
================================ */
.projects-grid {
  display:grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap:1.5rem;
}

/* ===============================
   CARDS
================================ */
.card {
  background: rgba(255,255,255,.08);
  backdrop-filter: blur(12px);
  border-radius:16px;
  box-shadow:0 15px 35px rgba(0,0,0,.25);
  transition:.3s;
  height:100%;
}
body.light .card { background: rgba(255,255,255,.95); }

.card:hover {
  transform: translateY(-6px);
}

.card-body {
  display:flex;
  flex-direction:column;
  gap:.6rem;
}

.card img.project-icon {
  width:32px;
  height:32px;
  border-radius:6px;
  object-fit:cover;
  vertical-align:middle;
  margin-right:6px;
}

/* ===============================
   BUTTONS (MOBILE SAFE)
================================ */
.card-actions {
  margin-top:auto;
  display:flex;
  flex-wrap:wrap;
  gap:.4rem;
}

.card-actions .btn {
  flex:1 1 auto;
  font-size:.85rem;
}

/* ===============================
   MENU BUTTON
================================ */
.menu-toggle {
  position: fixed;
  top: 18px;
  right: 18px;
  width: 52px;
  height: 52px;
  border-radius: 50%;
  border: none;
  font-size: 1.4rem;
  background: linear-gradient(135deg,#0d6efd,#6610f2);
  color:#fff;
  cursor:pointer;
  z-index:2000;
}

/* ===============================
   CONNECT ICONS (NO ID CLASH)
================================ */
.connect-icons {
  display:flex;
  justify-content:center;
  gap:1.2rem;
  flex-wrap:wrap;
  margin-top:1.5rem;
}

.connect-icons img {
  width:46px;
  transition:.3s;
}
.connect-icons img:hover {
  transform:scale(1.2);
  filter:drop-shadow(0 0 6px #0d6efd);
}

/* ===============================
   SMALL SCREENS
================================ */
@media(max-width:480px){
  .hero { padding:3rem 1rem; }
  .card-actions .btn { flex:1 1 100%; }
}
</style>

<!-- MENU TOGGLE -->
<button id="menuToggle" class="menu-toggle">â˜°</button>

<!-- HERO -->
<section class="hero">
  <h1>ğ•¯ğ–—. ğ•¬ğ–‘ğ–‘ğ–†ğ–“ ğ•±ğ–†ğ–Ÿğ–šğ–‘</h1>
  <p><span id="typed-text"></span><span class="cursor">|</span></p>
  <button onclick="toggleTheme()" class="btn btn-outline-light btn-sm">
    Toggle Theme
  </button>
</section>

<!-- PROJECTS -->
<section id="projects" class="section active container my-5">
  <h2 class="section-title">My Projects</h2>

  <div class="projects-grid">
    {% for project in projects %}
    <div class="card" data-aos="fade-up">
      <div class="card-body">
        <h5>
          {% if project.image %}
            <img src="{{ project.image.url }}" class="project-icon">
          {% endif %}
          {{ project.title }}
        </h5>

        <p>{{ project.description }}</p>
        <strong>{{ project.technology }}</strong>
        <small>ğŸ‘ {{ project.views }} views</small>

        <div class="card-actions">
          {% if project.github_link %}
            <a href="{{ project.github_link }}" target="_blank" class="btn btn-outline-primary btn-sm">GitHub</a>
          {% endif %}
          {% if project.demo_link %}
            <a href="{{ project.demo_link }}" target="_blank" class="btn btn-success btn-sm">Live</a>
          {% endif %}
          <button class="btn btn-outline-danger btn-sm like-btn" data-id="{{ project.id }}">
            â¤ï¸ <span id="likes-{{ project.id }}">{{ project.likes }}</span>
          </button>
          <a href="{% static "docs/Kanja Allan Ndung'u CV_20260202_161449_0000.pdf" %}" download class="btn btn-secondary btn-sm">
            CV
          </a>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
</section>

<!-- HIRE -->
<section id="hire" class="section container my-5">
  <h2 class="section-title">Hire Me</h2>
  <ul class="list-group list-group-flush">
    <li class="list-group-item">Django & Access Systems</li>
    <li class="list-group-item">Reports & Documentation</li>
    <li class="list-group-item">Excel Dashboards</li>
    <li class="list-group-item">Python, Java, JS, SQL</li>
  </ul>
  <p class="text-center mt-3">ğŸ“ 0704715655 | ğŸ“§ linux7506@gmail.com</p>
</section>

<!-- SUPPORT -->
<section id="support" class="section container text-center my-5">
  <h2 class="section-title">Support My Work</h2>
  <p><strong>M-PESA:</strong> 0704715655</p>
  <a class="btn btn-success" href="sms:+254704715655?body=Hi%20Allan%2C%20I%20just%20sent%20support%20via%20M-PESA">
    ğŸ’š I Sent Support
  </a>
</section>

<!-- DEALS -->
<section id="deals" class="section container my-5">
  <h2 class="section-title">Recommended Deals</h2>
  <div class="row text-center">
    <div class="col-md-6">
      <a href="https://jumia.link/your-code" target="_blank">
        <img src="https://res.cloudinary.com/dc6z1giw2/image/upload/v1770048401/jumia_csvtn2.png" style="max-height:60px">
        <p>Jumia Laptops</p>
      </a>
    </div>
    <div class="col-md-6">
      <a href="https://www.hostpinnacle.co.ke/clients/aff.php?aff=3171" target="_blank">
        <img src="https://res.cloudinary.com/dc6z1giw2/image/upload/v1770047858/hostpinnacle_osx9cj.png" style="max-height:60px">
        <p>HostPinnacle Hosting</p>
      </a>
    </div>
  </div>
</section>

<!-- CONNECT -->
<section id="connect" class="section container text-center my-5">
  <h2 class="section-title">Connect With Me</h2>
  <div class="connect-icons">
    <a href="https://wa.me/254704715655"><img src="https://img.icons8.com/color/48/whatsapp--v1.png"></a>
    <a href="https://instagram.com/d.f.w._.st3pp3r"><img src="https://img.icons8.com/color/48/instagram-new--v1.png"></a>
    <a href="https://facebook.com/buggystepper"><img src="https://img.icons8.com/color/48/facebook-new.png"></a>
    <a href="https://t.me/Stepper"><img src="https://img.icons8.com/color/48/telegram-app.png"></a>
  </div>
</section>

<!-- SCRIPT -->
<script>
(function(){
  document.addEventListener('DOMContentLoaded',function(){

    // Likes
    document.querySelectorAll('.like-btn').forEach(btn=>{
      btn.addEventListener('click',()=>{
        const id = btn.dataset.id;
        fetch(`/project/${id}/like/`,{
          method:'POST',
          headers:{
            'X-CSRFToken':document.cookie.split('csrftoken=')[1]
          }
        })
        .then(r=>r.json())
        .then(d=>{
          const el=document.getElementById(`likes-${id}`);
          if(el) el.textContent=d.likes;
        });
      });
    });

    // Menu toggle
    const sections=["projects","hire","support","deals","connect"];
    let i=0;
    document.getElementById('menuToggle')
      .addEventListener('click',()=>{
        sections.forEach(s=>document.getElementById(s).classList.remove('active'));
        i=(i+1)%sections.length;
        document.getElementById(sections[i]).classList.add('active');
      });
  });
})();
</script>

{% endblock %}
